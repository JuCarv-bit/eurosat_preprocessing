/users/c/carvalhj/miniconda3/envs/myenv/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:240: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[Epoch 001] Contrastive Loss: 5.9243
[Epoch 002] Contrastive Loss: 5.6628
[Epoch 003] Contrastive Loss: 5.4356
Traceback (most recent call last):
  File "/users/c/carvalhj/projects/eurosat_preprocessing/exploratory_notebooks/simclr/main.py", line 5, in <module>
    train_simclr(CONFIG)
  File "/users/c/carvalhj/projects/eurosat_preprocessing/exploratory_notebooks/simclr/train.py", line 63, in train_simclr
    loss = criterion(z1, z2)
  File "/users/c/carvalhj/miniconda3/envs/myenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/users/c/carvalhj/miniconda3/envs/myenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/users/c/carvalhj/projects/eurosat_preprocessing/exploratory_notebooks/simclr/models/loss.py", line 17, in forward
    mask = torch.eye(2 * N, dtype=torch.bool).to(self.device)
KeyboardInterrupt
